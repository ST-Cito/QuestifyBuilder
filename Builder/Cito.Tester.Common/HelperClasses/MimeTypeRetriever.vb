Imports System.IO
Imports System.Linq
Imports System.Runtime.InteropServices

Friend Class MimeTypeRetriever

    Private Shared ReadOnly _MIMETypesDictionary As New Dictionary(Of String, String)() From {
        {"123", "application/vnd.lotus-1-2-3"},
        {"323", "text/h323"},
        {"3dml", "text/vnd.in3d.3dml"},
        {"3g2", "video/3gpp2"},
        {"3gp", "video/3gpp"},
        {"3gp2", "video/3gpp2"},
        {"3gpp", "video/3gpp"},
        {"7z", "application/x-7z-compressed"},
        {"aa", "audio/audible"},
        {"aab", "application/x-authorware-bin"},
        {"aac", "audio/aac"},
        {"aaf", "application/octet-stream"},
        {"aam", "application/x-authorware-map"},
        {"aas", "application/x-authorware-seg"},
        {"aax", "audio/vnd.audible.aax"},
        {"abw", "application/x-abiword"},
        {"ac", "application/pkix-attr-cert"},
        {"ac3", "audio/ac3"},
        {"aca", "application/octet-stream"},
        {"acc", "application/vnd.americandynamics.acc"},
        {"accda", "application/msaccess.addin"},
        {"accdb", "application/msaccess"},
        {"accdc", "application/msaccess.cab"},
        {"accde", "application/msaccess"},
        {"accdr", "application/msaccess.runtime"},
        {"accdt", "application/msaccess"},
        {"accdw", "application/msaccess.webapplication"},
        {"accft", "application/msaccess.ftemplate"},
        {"ace", "application/x-ace-compressed"},
        {"acu", "application/vnd.acucobol"},
        {"acx", "application/internet-property-stream"},
        {"addin", "text/xml"},
        {"ade", "application/msaccess"},
        {"adobebridge", "application/x-bridge-url"},
        {"adp", "application/msaccess"},
        {"adt", "audio/vnd.dlna.adts"},
        {"adts", "audio/aac"},
        {"aep", "application/vnd.audiograph"},
        {"afm", "application/octet-stream"},
        {"afp", "application/vnd.ibm.modcap"},
        {"ahead", "application/vnd.ahead.space"},
        {"ai", "application/postscript"},
        {"aif", "audio/x-aiff"},
        {"aifc", "audio/aiff"},
        {"aiff", "audio/aiff"},
        {"air", "application/vnd.adobe.air-application-installer-package+zip"},
        {"ait", "application/vnd.dvb.ait"},
        {"amc", "application/x-mpeg"},
        {"ami", "application/vnd.amiga.ami"},
        {"apk", "application/vnd.android.package-archive"},
        {"application", "application/x-ms-application"},
        {"apr", "application/vnd.lotus-approach"},
        {"art", "image/x-jg"},
        {"asa", "application/xml"},
        {"asax", "application/xml"},
        {"asc", "text/plain"},
        {"ascx", "application/xml"},
        {"asd", "application/octet-stream"},
        {"asf", "video/x-ms-asf"},
        {"ashx", "application/xml"},
        {"asi", "application/octet-stream"},
        {"asm", "text/plain"},
        {"asmx", "application/xml"},
        {"aso", "application/vnd.accpac.simply.aso"},
        {"aspx", "application/xml"},
        {"asr", "video/x-ms-asf"},
        {"asx", "video/x-ms-asf"},
        {"atc", "application/vnd.acucorp"},
        {"atom", "application/atom+xml"},
        {"atomcat", "application/atomcat+xml"},
        {"atomsvc", "application/atomsvc+xml"},
        {"atx", "application/vnd.antix.game-component"},
        {"au", "audio/basic"},
        {"avi", "video/x-msvideo"},
        {"aw", "application/applixware"},
        {"axs", "application/olescript"},
        {"azf", "application/vnd.airzip.filesecure.azf"},
        {"azs", "application/vnd.airzip.filesecure.azs"},
        {"azw", "application/vnd.amazon.ebook"},
        {"bas", "text/plain"},
        {"bcpio", "application/x-bcpio"},
        {"bdf", "application/x-font-bdf"},
        {"bdm", "application/vnd.syncml.dm+wbxml"},
        {"bed", "application/vnd.realvnc.bed"},
        {"bh2", "application/vnd.fujitsu.oasysprs"},
        {"bin", "application/octet-stream"},
        {"bmi", "application/vnd.bmi"},
        {"bmp", "image/bmp"},
        {"box", "application/vnd.previewsystems.box"},
        {"btif", "image/prs.btif"},
        {"bz", "application/x-bzip"},
        {"bz2", "application/x-bzip2"},
        {"c", "text/plain"},
        {"c11amc", "application/vnd.cluetrust.cartomobile-config"},
        {"c11amz", "application/vnd.cluetrust.cartomobile-config-pkg"},
        {"c4g", "application/vnd.clonk.c4group"},
        {"cab", "application/octet-stream"},
        {"caf", "audio/x-caf"},
        {"calx", "application/vnd.ms-office.calx"},
        {"car", "application/vnd.curl.car"},
        {"cat", "application/vnd.ms-pki.seccat"},
        {"cc", "text/plain"},
        {"ccxml", "application/ccxml+xml"},
        {"cd", "text/plain"},
        {"cdbcmsg", "application/vnd.contact.cmsg"},
        {"cdda", "audio/aiff"},
        {"cdf", "application/x-cdf"},
        {"cdkey", "application/vnd.mediastation.cdkey"},
        {"cdmia", "application/cdmi-capability"},
        {"cdmic", "application/cdmi-container"},
        {"cdmid", "application/cdmi-domain"},
        {"cdmio", "application/cdmi-object"},
        {"cdmiq", "application/cdmi-queue"},
        {"cdx", "chemical/x-cdx"},
        {"cdxml", "application/vnd.chemdraw+xml"},
        {"cdy", "application/vnd.cinderella"},
        {"cer", "application/x-x509-ca-cert"},
        {"cgm", "image/cgm"},
        {"chat", "application/x-chat"},
        {"chm", "application/octet-stream"},
        {"chrt", "application/vnd.kde.kchart"},
        {"ci", "application/x-customInteraction"},
        {"cif", "chemical/x-cif"},
        {"cii", "application/vnd.anser-web-certificate-issue-initiation"},
        {"cil", "application/vnd.ms-artgalry"},
        {"cla", "application/vnd.claymore"},
        {"class", "application/x-java-applet"},
        {"clkk", "application/vnd.crick.clicker.keyboard"},
        {"clkp", "application/vnd.crick.clicker.palette"},
        {"clkt", "application/vnd.crick.clicker.template"},
        {"clkw", "application/vnd.crick.clicker.wordbank"},
        {"clkx", "application/vnd.crick.clicker"},
        {"clp", "application/x-msclip"},
        {"cmc", "application/vnd.cosmocaller"},
        {"cmdf", "chemical/x-cmdf"},
        {"cml", "chemical/x-cml"},
        {"cmp", "application/vnd.yellowriver-custom-menu"},
        {"cmx", "image/x-cmx"},
        {"cnf", "text/plain"},
        {"cod", "image/cis-cod"},
        {"config", "application/xml"},
        {"contact", "text/x-ms-contact"},
        {"coverage", "application/xml"},
        {"cpio", "application/x-cpio"},
        {"cpp", "text/plain"},
        {"cpt", "application/mac-compactpro"},
        {"crd", "application/x-mscardfile"},
        {"crl", "application/pkix-crl"},
        {"crt", "application/x-x509-ca-cert"},
        {"cryptonote", "application/vnd.rig.cryptonote"},
        {"cs", "text/plain"},
        {"csdproj", "text/plain"},
        {"csh", "application/x-csh"},
        {"csml", "chemical/x-csml"},
        {"csp", "application/vnd.commonspace"},
        {"csproj", "text/plain"},
        {"css", "text/css"},
        {"csv", "application/octet-stream"},
        {"cu", "application/cu-seeme"},
        {"cur", "application/octet-stream"},
        {"curl", "text/vnd.curl"},
        {"cww", "application/prs.cww"},
        {"cxx", "text/plain"},
        {"dae", "model/vnd.collada+xml"},
        {"daf", "application/vnd.mobius.daf"},
        {"dat", "application/octet-stream"},
        {"datasource", "application/xml"},
        {"davmount", "application/davmount+xml"},
        {"dbproj", "text/plain"},
        {"dcr", "application/x-director"},
        {"dcurl", "text/vnd.curl.dcurl"},
        {"dd2", "application/vnd.oma.dd2+xml"},
        {"ddd", "application/vnd.fujixerox.ddd"},
        {"deb", "application/x-debian-package"},
        {"def", "text/plain"},
        {"deploy", "application/octet-stream"},
        {"der", "application/x-x509-ca-cert"},
        {"dfac", "application/vnd.dreamfactory"},
        {"dgml", "application/xml"},
        {"dib", "image/bmp"},
        {"dif", "video/x-dv"},
        {"dir", "application/x-director"},
        {"dis", "application/vnd.mobius.dis"},
        {"disco", "text/xml"},
        {"djv", "image/vnd.djvu"},
        {"djvu", "image/vnd.djvu"},
        {"dll", "application/x-msdownload"},
        {"dll.config", "text/xml"},
        {"dlm", "text/dlm"},
        {"dmg", "application/octet-stream"},
        {"dms", "application/octet-stream"},
        {"dna", "application/vnd.dna"},
        {"doc", "application/msword"},
        {"docm", "application/vnd.ms-word.document.macroEnabled.12"},
        {"docx", "application/vnd.openxmlformats-officedocument.wordprocessingml.document"},
        {"dot", "application/msword"},
        {"dotm", "application/vnd.ms-word.template.macroEnabled.12"},
        {"dotx", "application/vnd.openxmlformats-officedocument.wordprocessingml.template"},
        {"dp", "application/vnd.osgi.dp"},
        {"dpg", "application/vnd.dpgraph"},
        {"dra", "audio/vnd.dra"},
        {"dsc", "text/prs.lines.tag"},
        {"dsp", "application/octet-stream"},
        {"dssc", "application/dssc+der"},
        {"dsw", "text/plain"},
        {"dtb", "application/x-dtbook+xml"},
        {"dtd", "text/xml"},
        {"dts", "audio/vnd.dts"},
        {"dtsconfig", "text/xml"},
        {"dtshd", "audio/vnd.dts.hd"},
        {"dv", "video/x-dv"},
        {"dvi", "application/x-dvi"},
        {"dwf", "drawing/x-dwf"},
        {"dwg", "image/vnd.dwg"},
        {"dwp", "application/octet-stream"},
        {"dxf", "image/vnd.dxf"},
        {"dxp", "application/vnd.spotfire.dxp"},
        {"dxr", "application/x-director"},
        {"ecelp4800", "audio/vnd.nuera.ecelp4800"},
        {"ecelp7470", "audio/vnd.nuera.ecelp7470"},
        {"ecelp9600", "audio/vnd.nuera.ecelp9600"},
        {"edm", "application/vnd.novadigm.edm"},
        {"edx", "application/vnd.novadigm.edx"},
        {"efif", "application/vnd.picsel"},
        {"ei6", "application/vnd.pg.osasli"},
        {"eml", "message/rfc822"},
        {"emma", "application/emma+xml"},
        {"emz", "application/octet-stream"},
        {"eol", "audio/vnd.digital-winds"},
        {"eot", "application/octet-stream"},
        {"eps", "application/postscript"},
        {"epub", "application/epub+zip"},
        {"es", "application/ecmascript"},
        {"es3", "application/vnd.eszigno3+xml"},
        {"esf", "application/vnd.epson.esf"},
        {"etl", "application/etl"},
        {"etx", "text/x-setext"},
        {"evy", "application/envoy"},
        {"exe", "application/octet-stream"},
        {"exe.config", "text/xml"},
        {"exi", "application/exi"},
        {"ext", "application/vnd.novadigm.ext"},
        {"ez", "application/andrew-inset"},
        {"ez2", "application/vnd.ezpix-album"},
        {"ez3", "application/vnd.ezpix-package"},
        {"f", "text/x-fortran"},
        {"f4v", "video/x-f4v"},
        {"fbs", "image/vnd.fastbidsheet"},
        {"fcs", "application/vnd.isac.fcs"},
        {"fdf", "application/vnd.fdf"},
        {"fe_launch", "application/vnd.denovo.fcselayout-link"},
        {"fg5", "application/vnd.fujitsu.oasysgp"},
        {"fh", "image/x-freehand"},
        {"fif", "application/fractals"},
        {"fig", "application/x-xfig"},
        {"filters", "Application/xml"},
        {"fla", "application/octet-stream"},
        {"fli", "video/x-fli"},
        {"flo", "application/vnd.micrografx.flo"},
        {"flr", "x-world/x-vrml"},
        {"flv", "video/x-flv"},
        {"flw", "application/vnd.kde.kivio"},
        {"flx", "text/vnd.fmi.flexstor"},
        {"fly", "text/vnd.fly"},
        {"fm", "application/vnd.framemaker"},
        {"fnc", "application/vnd.frogans.fnc"},
        {"fpx", "image/vnd.fpx"},
        {"fsc", "application/vnd.fsc.weblaunch"},
        {"fsscript", "application/fsharp-script"},
        {"fst", "image/vnd.fst"},
        {"fsx", "application/fsharp-script"},
        {"ftc", "application/vnd.fluxtime.clip"},
        {"fti", "application/vnd.anser-web-funds-transfer-initiation"},
        {"fvt", "video/vnd.fvt"},
        {"fxp", "application/vnd.adobe.fxp"},
        {"fzs", "application/vnd.fuzzysheet"},
        {"g2w", "application/vnd.geoplan"},
        {"g3", "image/g3fax"},
        {"g3w", "application/vnd.geospace"},
        {"gac", "application/vnd.groove-account"},
        {"gdl", "model/vnd.gdl"},
        {"generictest", "application/xml"},
        {"geo", "application/vnd.dynageo"},
        {"gex", "application/vnd.geometry-explorer"},
        {"ggb", "application/vnd.geogebra.file"},
        {"ggt", "application/vnd.geogebra.tool"},
        {"ghf", "application/vnd.groove-help"},
        {"gif", "image/gif"},
        {"gim", "application/vnd.groove-identity-message"},
        {"gmx", "application/vnd.gmx"},
        {"gnumeric", "application/x-gnumeric"},
        {"gph", "application/vnd.flographit"},
        {"gqf", "application/vnd.grafeq"},
        {"gram", "application/srgs"},
        {"group", "text/x-ms-group"},
        {"grv", "application/vnd.groove-injector"},
        {"grxml", "application/srgs+xml"},
        {"gsf", "application/x-font-ghostscript"},
        {"gsm", "audio/x-gsm"},
        {"gtar", "application/x-gtar"},
        {"gtm", "application/vnd.groove-tool-message"},
        {"gtw", "model/vnd.gtw"},
        {"gv", "text/vnd.graphviz"},
        {"gxt", "application/vnd.geonext"},
        {"gz", "application/x-gzip"},
        {"h", "text/plain"},
        {"h261", "video/h261"},
        {"h263", "video/h263"},
        {"h264", "video/h264"},
        {"hal", "application/vnd.hal+xml"},
        {"hbci", "application/vnd.hbci"},
        {"hdf", "application/x-hdf"},
        {"hdml", "text/x-hdml"},
        {"hhc", "application/x-oleobject"},
        {"hhk", "application/octet-stream"},
        {"hhp", "application/octet-stream"},
        {"hlp", "application/winhlp"},
        {"hpgl", "application/vnd.hp-hpgl"},
        {"hpid", "application/vnd.hp-hpid"},
        {"hpp", "text/plain"},
        {"hps", "application/vnd.hp-hps"},
        {"hqx", "application/mac-binhex40"},
        {"hta", "application/hta"},
        {"htc", "text/x-component"},
        {"htke", "application/vnd.kenameaapp"},
        {"htm", "text/html"},
        {"html", "text/html"},
        {"htt", "text/webviewhtml"},
        {"hvd", "application/vnd.yamaha.hv-dic"},
        {"hvp", "application/vnd.yamaha.hv-voice"},
        {"hvs", "application/vnd.yamaha.hv-script"},
        {"hxa", "application/xml"},
        {"hxc", "application/xml"},
        {"hxd", "application/octet-stream"},
        {"hxe", "application/xml"},
        {"hxf", "application/xml"},
        {"hxh", "application/octet-stream"},
        {"hxi", "application/octet-stream"},
        {"hxk", "application/xml"},
        {"hxq", "application/octet-stream"},
        {"hxr", "application/octet-stream"},
        {"hxs", "application/octet-stream"},
        {"hxt", "text/html"},
        {"hxv", "application/xml"},
        {"hxw", "application/octet-stream"},
        {"hxx", "text/plain"},
        {"i", "text/plain"},
        {"i2g", "application/vnd.intergeo"},
        {"icc", "application/vnd.iccprofile"},
        {"ice", "x-conference/x-cooltalk"},
        {"ico", "image/x-icon"},
        {"ics", "application/octet-stream"},
        {"idl", "text/plain"},
        {"ief", "image/ief"},
        {"ifb", "text/calendar"},
        {"ifm", "application/vnd.shana.informed.formdata"},
        {"iges", "model/iges"},
        {"igl", "application/vnd.igloader"},
        {"igm", "application/vnd.insors.igm"},
        {"igs", "model/iges"},
        {"igx", "application/vnd.micrografx.igx"},
        {"iif", "application/vnd.shana.informed.interchange"},
        {"iii", "application/x-iphone"},
        {"imp", "application/vnd.accpac.simply.imp"},
        {"ims", "application/vnd.ms-ims"},
        {"inc", "text/plain"},
        {"inf", "application/octet-stream"},
        {"inl", "text/plain"},
        {"ins", "application/x-internet-signup"},
        {"ipa", "application/x-itunes-ipa"},
        {"ipfix", "application/ipfix"},
        {"ipg", "application/x-itunes-ipg"},
        {"ipk", "application/vnd.shana.informed.package"},
        {"ipproj", "text/plain"},
        {"ipsw", "application/x-itunes-ipsw"},
        {"iqy", "text/x-ms-iqy"},
        {"irm", "application/vnd.ibm.rights-management"},
        {"irp", "application/vnd.irepository.package+xml"},
        {"isp", "application/x-internet-signup"},
        {"ite", "application/x-itunes-ite"},
        {"itlp", "application/x-itunes-itlp"},
        {"itms", "application/x-itunes-itms"},
        {"itp", "application/vnd.shana.informed.formtemplate"},
        {"itpc", "application/x-itunes-itpc"},
        {"ivf", "video/x-ivf"},
        {"ivp", "application/vnd.immervision-ivp"},
        {"ivu", "application/vnd.immervision-ivu"},
        {"jad", "text/vnd.sun.j2me.app-descriptor"},
        {"jam", "application/vnd.jam"},
        {"jar", "application/java-archive"},
        {"java", "application/octet-stream"},
        {"jck", "application/liquidmotion"},
        {"jcz", "application/liquidmotion"},
        {"jfif", "image/pjpeg"},
        {"jisp", "application/vnd.jisp"},
        {"jlt", "application/vnd.hp-jlyt"},
        {"jnlp", "application/x-java-jnlp-file"},
        {"joda", "application/vnd.joost.joda-archive"},
        {"jp2", "image/jp2"},
        {"jpb", "application/octet-stream"},
        {"jpg", "image/jpeg"},
        {"jpe", "image/jpeg"},
        {"jpeg", "image/jpeg"},
        {"jpgv", "video/jpeg"},
        {"jpm", "video/jpm"},
        {"js", "application/x-javascript"},
        {"json", "application/json"},
        {"jsx", "text/jscript"},
        {"jsxbin", "text/plain"},
        {"kar", "audio/midi"},
        {"karbon", "application/vnd.kde.karbon"},
        {"kfo", "application/vnd.kde.kformula"},
        {"kia", "application/vnd.kidspiration"},
        {"kml", "application/vnd.google-earth.kml+xml"},
        {"kmz", "application/vnd.google-earth.kmz"},
        {"kne", "application/vnd.kinar"},
        {"kon", "application/vnd.kde.kontour"},
        {"kpr", "application/vnd.kde.kpresenter"},
        {"ksp", "application/vnd.kde.kspread"},
        {"ktx", "image/ktx"},
        {"ktz", "application/vnd.kahootz"},
        {"kwd", "application/vnd.kde.kword"},
        {"lasxml", "application/vnd.las.las+xml"},
        {"latex", "application/x-latex"},
        {"lbd", "application/vnd.llamagraphics.life-balance.desktop"},
        {"lbe", "application/vnd.llamagraphics.life-balance.exchange+xml"},
        {"les", "application/vnd.hhe.lesson-player"},
        {"lha", "application/octet-stream"},
        {"library-ms", "application/windows-library+xml"},
        {"link66", "application/vnd.route66.link66+xml"},
        {"lit", "application/x-ms-reader"},
        {"loadtest", "application/xml"},
        {"lpk", "application/octet-stream"},
        {"lrm", "application/vnd.ms-lrm"},
        {"lsf", "video/x-la-asf"},
        {"lst", "text/plain"},
        {"lsx", "video/x-la-asf"},
        {"ltf", "application/vnd.frogans.ltf"},
        {"lvp", "audio/vnd.lucent.voice"},
        {"lwp", "application/vnd.lotus-wordpro"},
        {"lzh", "application/octet-stream"},
        {"m13", "application/x-msmediaview"},
        {"m14", "application/x-msmediaview"},
        {"m1v", "video/mpeg"},
        {"m21", "application/mp21"},
        {"m2t", "video/vnd.dlna.mpeg-tts"},
        {"m2ts", "video/vnd.dlna.mpeg-tts"},
        {"m2v", "video/mpeg"},
        {"m3u", "audio/x-mpegurl"},
        {"m3u8", "audio/x-mpegurl"},
        {"m4a", "audio/m4a"},
        {"m4b", "audio/m4b"},
        {"m4p", "audio/m4p"},
        {"m4r", "audio/x-m4r"},
        {"m4u", "video/vnd.mpegurl"},
        {"m4v", "video/x-m4v"},
        {"ma", "application/mathematica"},
        {"mac", "image/x-macpaint"},
        {"mads", "application/mads+xml"},
        {"mag", "application/vnd.ecowin.chart"},
        {"mak", "text/plain"},
        {"man", "application/x-troff-man"},
        {"manifest", "application/x-ms-manifest"},
        {"map", "text/plain"},
        {"master", "application/xml"},
        {"mathml", "application/mathml+xml"},
        {"mbk", "application/vnd.mobius.mbk"},
        {"mbox", "application/mbox"},
        {"mc1", "application/vnd.medcalcdata"},
        {"mcd", "application/vnd.mcd"},
        {"mcurl", "text/vnd.curl.mcurl"},
        {"mda", "application/msaccess"},
        {"mdb", "application/x-msaccess"},
        {"mde", "application/msaccess"},
        {"mdi", "image/vnd.ms-modi"},
        {"mdp", "application/octet-stream"},
        {"me", "application/x-troff-me"},
        {"mesh", "model/mesh"},
        {"meta4", "application/metalink4+xml"},
        {"mets", "application/mets+xml"},
        {"mfm", "application/vnd.mfmp"},
        {"mgp", "application/vnd.osgeo.mapguide.package"},
        {"mgz", "application/vnd.proteus.magazine"},
        {"mht", "message/rfc822"},
        {"mhtml", "message/rfc822"},
        {"mid", "audio/mid"},
        {"midi", "audio/mid"},
        {"mif", "application/vnd.mif"},
        {"mix", "application/octet-stream"},
        {"mj2", "video/mj2"},
        {"mk", "text/plain"},
        {"mlp", "application/vnd.dolby.mlp"},
        {"mmd", "application/vnd.chipnuts.karaoke-mmd"},
        {"mmf", "application/x-smaf"},
        {"mmr", "image/vnd.fujixerox.edmics-mmr"},
        {"mno", "text/xml"},
        {"mny", "application/x-msmoney"},
        {"mod", "video/mpeg"},
        {"mods", "application/mods+xml"},
        {"mov", "video/quicktime"},
        {"movie", "video/x-sgi-movie"},
        {"mp2", "video/mpeg"},
        {"mp2v", "video/mpeg"},
        {"mp3", "audio/mpeg"},
        {"mp4", "video/mp4"},
        {"mp4a", "audio/mp4"},
        {"mp4v", "video/mp4"},
        {"mpa", "video/mpeg"},
        {"mpc", "application/vnd.mophun.certificate"},
        {"mpe", "video/mpeg"},
        {"mpeg", "video/mpeg"},
        {"mpf", "application/vnd.ms-mediapackage"},
        {"mpg", "video/mpeg"},
        {"mpga", "audio/mpeg"},
        {"mpkg", "application/vnd.apple.installer+xml"},
        {"mpm", "application/vnd.blueice.multipass"},
        {"mpn", "application/vnd.mophun.application"},
        {"mpp", "application/vnd.ms-project"},
        {"mpv2", "video/mpeg"},
        {"mpy", "application/vnd.ibm.minipay"},
        {"mqv", "video/quicktime"},
        {"mqy", "application/vnd.mobius.mqy"},
        {"mrc", "application/marc"},
        {"mrcx", "application/marcxml+xml"},
        {"ms", "application/x-troff-ms"},
        {"mscml", "application/mediaservercontrol+xml"},
        {"mseq", "application/vnd.mseq"},
        {"msf", "application/vnd.epson.msf"},
        {"msh", "model/mesh"},
        {"msi", "application/octet-stream"},
        {"msl", "application/vnd.mobius.msl"},
        {"mso", "application/octet-stream"},
        {"msty", "application/vnd.muvee.style"},
        {"mts", "video/vnd.dlna.mpeg-tts"},
        {"mtx", "application/xml"},
        {"mus", "application/vnd.musician"},
        {"musicxml", "application/vnd.recordare.musicxml+xml"},
        {"mvb", "application/x-msmediaview"},
        {"mvc", "application/x-miva-compiled"},
        {"mwf", "application/vnd.mfer"},
        {"mxf", "application/mxf"},
        {"mxl", "application/vnd.recordare.musicxml"},
        {"mxml", "application/xv+xml"},
        {"mxp", "application/x-mmxp"},
        {"mxs", "application/vnd.triscape.mxs"},
        {"mxu", "video/vnd.mpegurl"},
        {"n3", "text/n3"},
        {"nbp", "application/vnd.wolfram.player"},
        {"nc", "application/x-netcdf"},
        {"ncx", "application/x-dtbncx+xml"},
        {"n-gage", "application/vnd.nokia.n-gage.symbian.install"},
        {"ngdat", "application/vnd.nokia.n-gage.data"},
        {"nlu", "application/vnd.neurolanguage.nlu"},
        {"nml", "application/vnd.enliven"},
        {"nnd", "application/vnd.noblenet-directory"},
        {"nns", "application/vnd.noblenet-sealer"},
        {"nnw", "application/vnd.noblenet-web"},
        {"npx", "image/vnd.net-fpx"},
        {"nsc", "video/x-ms-asf"},
        {"nsf", "application/vnd.lotus-notes"},
        {"nws", "message/rfc822"},
        {"oa2", "application/vnd.fujitsu.oasys2"},
        {"oa3", "application/vnd.fujitsu.oasys3"},
        {"oas", "application/vnd.fujitsu.oasys"},
        {"obd", "application/x-msbinder"},
        {"ocx", "application/octet-stream"},
        {"oda", "application/oda"},
        {"odb", "application/vnd.oasis.opendocument.database"},
        {"odc", "text/x-ms-odc"},
        {"odf", "application/vnd.oasis.opendocument.formula"},
        {"odft", "application/vnd.oasis.opendocument.formula-template"},
        {"odg", "application/vnd.oasis.opendocument.graphics"},
        {"odh", "text/plain"},
        {"odi", "application/vnd.oasis.opendocument.image"},
        {"odl", "text/plain"},
        {"odm", "application/vnd.oasis.opendocument.text-master"},
        {"odp", "application/vnd.oasis.opendocument.presentation"},
        {"ods", "application/oleobject"},
        {"odt", "application/vnd.oasis.opendocument.text"},
        {"oga", "audio/ogg"},
        {"ogg", "audio/ogg"},
        {"ogv", "video/ogg"},
        {"ogx", "application/ogg"},
        {"one", "application/onenote"},
        {"onea", "application/onenote"},
        {"onepkg", "application/onenote"},
        {"onetmp", "application/onenote"},
        {"onetoc", "application/onenote"},
        {"onetoc2", "application/onenote"},
        {"opf", "application/oebps-package+xml"},
        {"opus", "audio/ogg"},
        {"orderedtest", "application/xml"},
        {"org", "application/vnd.lotus-organizer"},
        {"osdx", "application/opensearchdescription+xml"},
        {"osf", "application/vnd.yamaha.openscoreformat"},
        {"osfpvg", "application/vnd.yamaha.openscoreformat.osfpvg+xml"},
        {"otc", "application/vnd.oasis.opendocument.chart-template"},
        {"otd", "application/octet-stream"},
        {"otf", "application/x-font-otf"},
        {"otg", "application/vnd.oasis.opendocument.graphics-template"},
        {"oth", "application/vnd.oasis.opendocument.text-web"},
        {"oti", "application/vnd.oasis.opendocument.image-template"},
        {"otp", "application/vnd.oasis.opendocument.presentation-template"},
        {"ots", "application/vnd.oasis.opendocument.spreadsheet-template"},
        {"ott", "application/vnd.oasis.opendocument.text-template"},
        {"oxt", "application/vnd.openofficeorg.extension"},
        {"p", "text/x-pascal"},
        {"p10", "application/pkcs10"},
        {"p12", "application/x-pkcs12"},
        {"p7b", "application/x-pkcs7-certificates"},
        {"p7c", "application/pkcs7-mime"},
        {"p7m", "application/pkcs7-mime"},
        {"p7r", "application/x-pkcs7-certreqresp"},
        {"p7s", "application/pkcs7-signature"},
        {"p8", "application/pkcs8"},
        {"package", "application/x-zip-compressed"},
        {"paw", "application/vnd.pawaafile"},
        {"pbd", "application/vnd.powerbuilder6"},
        {"pbm", "image/x-portable-bitmap"},
        {"pcast", "application/x-podcast"},
        {"pcf", "application/x-font-pcf"},
        {"pci", "application/x-portableCustomInteraction"},
        {"pcl", "application/vnd.hp-pcl"},
        {"pclxl", "application/vnd.hp-pclxl"},
        {"pct", "image/pict"},
        {"pcurl", "application/vnd.curl.pcurl"},
        {"pcx", "application/octet-stream"},
        {"pcz", "application/octet-stream"},
        {"pdb", "chemical/x-pdb"},
        {"pdf", "application/pdf"},
        {"pfa", "application/x-font-type1"},
        {"pfb", "application/octet-stream"},
        {"pfm", "application/octet-stream"},
        {"pfr", "application/font-tdpfr"},
        {"pfx", "application/x-pkcs12"},
        {"pgm", "image/x-portable-graymap"},
        {"pgn", "application/x-chess-pgn"},
        {"pgp", "application/pgp-signature"},
        {"pic", "image/pict"},
        {"pict", "image/pict"},
        {"pkgdef", "text/plain"},
        {"pkgundef", "text/plain"},
        {"pki", "application/pkixcmp"},
        {"pkipath", "application/pkix-pkipath"},
        {"pko", "application/vnd.ms-pki.pko"},
        {"plb", "application/vnd.3gpp.pic-bw-large"},
        {"plc", "application/vnd.mobius.plc"},
        {"plf", "application/vnd.pocketlearn"},
        {"pls", "audio/scpls"},
        {"pma", "application/x-perfmon"},
        {"pmc", "application/x-perfmon"},
        {"pml", "application/x-perfmon"},
        {"pmr", "application/x-perfmon"},
        {"pmw", "application/x-perfmon"},
        {"png", "image/png"},
        {"pnm", "image/x-portable-anymap"},
        {"pnt", "image/x-macpaint"},
        {"pntg", "image/x-macpaint"},
        {"pnz", "image/png"},
        {"portpkg", "application/vnd.macports.portpkg"},
        {"pot", "application/vnd.ms-powerpoint"},
        {"potm", "application/vnd.ms-powerpoint.template.macroEnabled.12"},
        {"potx", "application/vnd.openxmlformats-officedocument.presentationml.template"},
        {"ppa", "application/vnd.ms-powerpoint"},
        {"ppam", "application/vnd.ms-powerpoint.addin.macroEnabled.12"},
        {"ppd", "application/vnd.cups-ppd"},
        {"ppm", "image/x-portable-pixmap"},
        {"pps", "application/vnd.ms-powerpoint"},
        {"ppsm", "application/vnd.ms-powerpoint.slideshow.macroEnabled.12"},
        {"ppsx", "application/vnd.openxmlformats-officedocument.presentationml.slideshow"},
        {"ppt", "application/vnd.ms-powerpoint"},
        {"pptm", "application/vnd.ms-powerpoint.presentation.macroEnabled.12"},
        {"pptx", "application/vnd.openxmlformats-officedocument.presentationml.presentation"},
        {"prc", "application/x-mobipocket-ebook"},
        {"pre", "application/vnd.lotus-freelance"},
        {"prf", "application/pics-rules"},
        {"prm", "application/octet-stream"},
        {"prx", "application/octet-stream"},
        {"ps", "application/postscript"},
        {"psb", "application/vnd.3gpp.pic-bw-small"},
        {"psc1", "application/PowerShell"},
        {"psd", "application/octet-stream"},
        {"psess", "application/xml"},
        {"psf", "application/x-font-linux-psf"},
        {"pskcxml", "application/pskc+xml"},
        {"psm", "application/octet-stream"},
        {"psp", "application/octet-stream"},
        {"ptid", "application/vnd.pvi.ptid1"},
        {"pub", "application/x-mspublisher"},
        {"pvb", "application/vnd.3gpp.pic-bw-var"},
        {"pwn", "application/vnd.3m.post-it-notes"},
        {"pwz", "application/vnd.ms-powerpoint"},
        {"pya", "audio/vnd.ms-playready.media.pya"},
        {"pyv", "video/vnd.ms-playready.media.pyv"},
        {"qam", "application/vnd.epson.quickanime"},
        {"qbo", "application/vnd.intu.qbo"},
        {"qfx", "application/vnd.intu.qfx"},
        {"qht", "text/x-html-insertion"},
        {"qhtm", "text/x-html-insertion"},
        {"qps", "application/vnd.publishare-delta-tree"},
        {"qt", "video/quicktime"},
        {"qti", "image/x-quicktime"},
        {"qtif", "image/x-quicktime"},
        {"qtl", "application/x-quicktimeplayer"},
        {"qxd", "application/octet-stream"},
        {"ra", "audio/x-pn-realaudio"},
        {"ram", "audio/x-pn-realaudio"},
        {"rar", "application/octet-stream"},
        {"ras", "image/x-cmu-raster"},
        {"rat", "application/rat-file"},
        {"rc", "text/plain"},
        {"rc2", "text/plain"},
        {"rcprofile", "application/vnd.ipunplugged.rcprofile"},
        {"rct", "text/plain"},
        {"rdf", "application/rdf+xml"},
        {"rdlc", "application/xml"},
        {"rdz", "application/vnd.data-vision.rdz"},
        {"rep", "application/vnd.businessobjects"},
        {"res", "application/x-dtbresource+xml"},
        {"resx", "application/xml"},
        {"rf", "image/vnd.rn-realflash"},
        {"rgb", "image/x-rgb"},
        {"rgs", "text/plain"},
        {"rif", "application/reginfo+xml"},
        {"rip", "audio/vnd.rip"},
        {"rl", "application/resource-lists+xml"},
        {"rlc", "image/vnd.fujixerox.edmics-rlc"},
        {"rld", "application/resource-lists-diff+xml"},
        {"rm", "application/vnd.rn-realmedia"},
        {"rmi", "audio/mid"},
        {"rmp", "application/vnd.rn-rn_music_package"},
        {"rms", "application/vnd.jcp.javame.midlet-rms"},
        {"rnc", "application/relax-ng-compact-syntax"},
        {"roff", "application/x-troff"},
        {"rp9", "application/vnd.cloanto.rp9"},
        {"rpm", "audio/x-pn-realaudio-plugin"},
        {"rpss", "application/vnd.nokia.radio-presets"},
        {"rpst", "application/vnd.nokia.radio-preset"},
        {"rq", "application/sparql-query"},
        {"rqy", "text/x-ms-rqy"},
        {"rs", "application/rls-services+xml"},
        {"rsd", "application/rsd+xml"},
        {"rss", ".xml"},
        {"rtf", "application/rtf"},
        {"rtx", "text/richtext"},
        {"ruleset", "application/xml"},
        {"s", "text/plain"},
        {"saf", "application/vnd.yamaha.smaf-audio"},
        {"safariextz", "application/x-safari-safariextz"},
        {"sbml", "application/sbml+xml"},
        {"sc", "application/vnd.ibm.secure-container"},
        {"scd", "application/x-msschedule"},
        {"scm", "application/vnd.lotus-screencam"},
        {"scq", "application/scvp-cv-request"},
        {"scs", "application/scvp-cv-response"},
        {"sct", "text/scriptlet"},
        {"scurl", "text/vnd.curl.scurl"},
        {"sd2", "audio/x-sd2"},
        {"sda", "application/vnd.stardivision.draw"},
        {"sdc", "application/vnd.stardivision.calc"},
        {"sdd", "application/vnd.stardivision.impress"},
        {"sdkm", "application/vnd.solent.sdkm+xml"},
        {"sdp", "application/sdp"},
        {"sdw", "application/vnd.stardivision.writer"},
        {"sea", "application/octet-stream"},
        {"searchconnector-ms", "application/windows-search-connector+xml"},
        {"see", "application/vnd.seemail"},
        {"seed", "application/vnd.fdsn.seed"},
        {"sema", "application/vnd.sema"},
        {"semd", "application/vnd.semd"},
        {"semf", "application/vnd.semf"},
        {"ser", "application/java-serialized-object"},
        {"setpay", "application/set-payment-initiation"},
        {"setreg", "application/set-registration-initiation"},
        {"settings", "application/xml"},
        {"sfd-hdstx", "application/vnd.hydrostatix.sof-data"},
        {"sfs", "application/vnd.spotfire.sfs"},
        {"sgimb", "application/x-sgimb"},
        {"sgl", "application/vnd.stardivision.writer-global"},
        {"sgm", "text/sgml"},
        {"sgml", "text/sgml"},
        {"sh", "application/x-sh"},
        {"shar", "application/x-shar"},
        {"shf", "application/shf+xml"},
        {"shtml", "text/html"},
        {"silo", "model/mesh"},
        {"sis", "application/vnd.symbian.install"},
        {"sit", "application/x-stuffit"},
        {"sitemap", "application/xml"},
        {"sitx", "application/x-stuffitx"},
        {"skd", "application/x-koan"},
        {"skin", "application/xml"},
        {"skm", "application/x-koan"},
        {"skp", "application/x-koan"},
        {"skt", "application/x-koan"},
        {"sldm", "application/vnd.ms-powerpoint.slide.macroEnabled.12"},
        {"sldx", "application/vnd.openxmlformats-officedocument.presentationml.slide"},
        {"slk", "application/vnd.ms-excel"},
        {"sln", "text/plain"},
        {"slt", "application/vnd.epson.salt"},
        {"slupkg-ms", "application/x-ms-license"},
        {"sm", "application/vnd.stepmania.stepchart"},
        {"smd", "audio/x-smd"},
        {"smf", "application/vnd.stardivision.math"},
        {"smi", "application/octet-stream"},
        {"smil", "application/smil"},
        {"smx", "audio/x-smd"},
        {"smz", "audio/x-smd"},
        {"snd", "audio/basic"},
        {"snf", "application/x-font-snf"},
        {"snippet", "application/xml"},
        {"snp", "application/octet-stream"},
        {"so", "application/octet-stream"},
        {"sol", "text/plain"},
        {"sor", "text/plain"},
        {"spc", "application/x-pkcs7-certificates"},
        {"spf", "application/vnd.yamaha.smaf-phrase"},
        {"spl", "application/futuresplash"},
        {"spot", "text/vnd.in3d.spot"},
        {"spp", "application/scvp-vp-response"},
        {"spq", "application/scvp-vp-request"},
        {"src", "application/x-wais-source"},
        {"srf", "text/plain"},
        {"sru", "application/sru+xml"},
        {"srx", "application/sparql-results+xml"},
        {"sse", "application/vnd.kodak-descriptor"},
        {"ssf", "application/vnd.epson.ssf"},
        {"ssisdeploymentmanifest", "text/xml"},
        {"ssm", "application/streamingmedia"},
        {"ssml", "application/ssml+xml"},
        {"sst", "application/vnd.ms-pki.certstore"},
        {"st", "application/vnd.sailingtracker.track"},
        {"stc", "application/vnd.sun.xml.calc.template"},
        {"std", "application/vnd.sun.xml.draw.template"},
        {"stf", "application/vnd.wt.stf"},
        {"sti", "application/vnd.sun.xml.impress.template"},
        {"stk", "application/hyperstudio"},
        {"stl", "application/vnd.ms-pki.stl"},
        {"str", "application/vnd.pg.format"},
        {"stw", "application/vnd.sun.xml.writer.template"},
        {"sub", "image/vnd.dvb.subtitle"},
        {"sus", "application/vnd.sus-calendar"},
        {"sv4cpio", "application/x-sv4cpio"},
        {"sv4crc", "application/x-sv4crc"},
        {"svc", "application/xml"},
        {"svd", "application/vnd.svd"},
        {"svg", "image/svg+xml"},
        {"swi", "application/vnd.aristanetworks.swi"},
        {"sxc", "application/vnd.sun.xml.calc"},
        {"sxd", "application/vnd.sun.xml.draw"},
        {"sxg", "application/vnd.sun.xml.writer.global"},
        {"sxi", "application/vnd.sun.xml.impress"},
        {"sxm", "application/vnd.sun.xml.math"},
        {"sxw", "application/vnd.sun.xml.writer"},
        {"t", "application/x-troff"},
        {"tao", "application/vnd.tao.intent-module-archive"},
        {"tar", "application/x-tar"},
        {"tcap", "application/vnd.3gpp2.tcap"},
        {"tcl", "application/x-tcl"},
        {"teacher", "application/vnd.smart.teacher"},
        {"tei", "application/tei+xml"},
        {"testrunconfig", "application/xml"},
        {"testsettings", "application/xml"},
        {"tex", "application/x-tex"},
        {"texi", "application/x-texinfo"},
        {"texinfo", "application/x-texinfo"},
        {"tfi", "application/thraud+xml"},
        {"tfm", "application/x-tex-tfm"},
        {"tgz", "application/x-compressed"},
        {"thmx", "application/vnd.ms-officetheme"},
        {"thn", "application/octet-stream"},
        {"tif", "image/tiff"},
        {"tiff", "image/tiff"},
        {"tlh", "text/plain"},
        {"tli", "text/plain"},
        {"tmo", "application/vnd.tmobile-livetv"},
        {"toc", "application/octet-stream"},
        {"torrent", "application/x-bittorrent"},
        {"tpl", "application/vnd.groove-tool-template"},
        {"tpt", "application/vnd.trid.tpt"},
        {"tr", "application/x-troff"},
        {"tra", "application/vnd.trueapp"},
        {"trm", "application/x-msterminal"},
        {"trx", "application/xml"},
        {"ts", "video/vnd.dlna.mpeg-tts"},
        {"tsd", "application/timestamped-data"},
        {"tsv", "text/tab-separated-values"},
        {"ttf", "application/octet-stream"},
        {"ttl", "text/turtle"},
        {"tts", "video/vnd.dlna.mpeg-tts"},
        {"twd", "application/vnd.simtech-mindmapper"},
        {"txd", "application/vnd.genomatix.tuxedo"},
        {"txf", "application/vnd.mobius.txf"},
        {"txt", "text/plain"},
        {"u32", "application/octet-stream"},
        {"ufd", "application/vnd.ufdl"},
        {"uls", "text/iuls"},
        {"umj", "application/vnd.umajin"},
        {"unityweb", "application/vnd.unity"},
        {"uoml", "application/vnd.uoml+xml"},
        {"uri", "text/uri-list"},
        {"user", "text/plain"},
        {"ustar", "application/x-ustar"},
        {"utz", "application/vnd.uiq.theme"},
        {"uu", "text/x-uuencode"},
        {"uva", "audio/vnd.dece.audio"},
        {"uvh", "video/vnd.dece.hd"},
        {"uvi", "image/vnd.dece.graphic"},
        {"uvm", "video/vnd.dece.mobile"},
        {"uvp", "video/vnd.dece.pd"},
        {"uvs", "video/vnd.dece.sd"},
        {"uvu", "video/vnd.uvvu.mp4"},
        {"uvv", "video/vnd.dece.video"},
        {"vb", "text/plain"},
        {"vbdproj", "text/plain"},
        {"vbk", "video/mpeg"},
        {"vbproj", "text/plain"},
        {"vbs", "text/vbscript"},
        {"vcd", "application/x-cdlink"},
        {"vcf", "text/x-vcard"},
        {"vcg", "application/vnd.groove-vcard"},
        {"vcproj", "Application/xml"},
        {"vcs", "text/plain"},
        {"vcx", "application/vnd.vcx"},
        {"vcxproj", "Application/xml"},
        {"vddproj", "text/plain"},
        {"vdp", "text/plain"},
        {"vdproj", "text/plain"},
        {"vdx", "application/vnd.ms-visio.viewer"},
        {"vis", "application/vnd.visionary"},
        {"viv", "video/vnd.vivo"},
        {"vml", "text/xml"},
        {"vrml", "model/vrml"},
        {"vscontent", "application/xml"},
        {"vsct", "text/xml"},
        {"vsd", "application/vnd.visio"},
        {"vsf", "application/vnd.vsf"},
        {"vsi", "application/ms-vsi"},
        {"vsix", "application/vsix"},
        {"vsixlangpack", "text/xml"},
        {"vsixmanifest", "text/xml"},
        {"vsmdi", "application/xml"},
        {"vspscc", "text/plain"},
        {"vss", "application/vnd.visio"},
        {"vsscc", "text/plain"},
        {"vssettings", "text/xml"},
        {"vssscc", "text/plain"},
        {"vst", "application/vnd.visio"},
        {"vstemplate", "text/xml"},
        {"vsto", "application/x-ms-vsto"},
        {"vsw", "application/vnd.visio"},
        {"vsx", "application/vnd.visio"},
        {"vtu", "model/vnd.vtu"},
        {"vtx", "application/vnd.visio"},
        {"vxml", "application/voicexml+xml"},
        {"wad", "application/x-doom"},
        {"wav", "audio/wav"},
        {"wave", "audio/wav"},
        {"wax", "audio/x-ms-wax"},
        {"wbk", "application/msword"},
        {"wbmp", "image/vnd.wap.wbmp"},
        {"wbmxl", "application/vnd.wap.wbxml"},
        {"wbs", "application/vnd.criticaltools.wbs+xml"},
        {"wbxml", "application/vnd.wap.wbxml"},
        {"wcm", "application/vnd.ms-works"},
        {"wdb", "application/vnd.ms-works"},
        {"wdp", "image/vnd.ms-photo"},
        {"weba", "audio/webm"},
        {"webarchive", "application/x-safari-webarchive"},
        {"webm", "video/webm"},
        {"webp", "image/webp"},
        {"webtest", "application/xml"},
        {"wg", "application/vnd.pmi.widget"},
        {"wgt", "application/widget"},
        {"wiq", "application/xml"},
        {"wiz", "application/msword"},
        {"wks", "application/vnd.ms-works"},
        {"wlmp", "application/wlmoviemaker"},
        {"wlpginstall", "application/x-wlpg-detect"},
        {"wlpginstall3", "application/x-wlpg3-detect"},
        {"wm", "video/x-ms-wm"},
        {"wma", "audio/x-ms-wma"},
        {"wmd", "application/x-ms-wmd"},
        {"wmf", "application/x-msmetafile"},
        {"wml", "text/vnd.wap.wml"},
        {"wmlc", "application/vnd.wap.wmlc"},
        {"wmls", "text/vnd.wap.wmlscript"},
        {"wmlsc", "application/vnd.wap.wmlscriptc"},
        {"wmp", "video/x-ms-wmp"},
        {"wmv", "video/x-ms-wmv"},
        {"wmx", "video/x-ms-wmx"},
        {"wmz", "application/x-ms-wmz"},
        {"woff", "application/x-font-woff"},
        {"wpd", "application/vnd.wordperfect"},
        {"wpl", "application/vnd.ms-wpl"},
        {"wps", "application/vnd.ms-works"},
        {"wqd", "application/vnd.wqd"},
        {"wri", "application/x-mswrite"},
        {"wrl", "x-world/x-vrml"},
        {"wrz", "x-world/x-vrml"},
        {"wsc", "text/scriptlet"},
        {"wsdl", "text/xml"},
        {"wspolicy", "application/wspolicy+xml"},
        {"wtb", "application/vnd.webturbo"},
        {"wvx", "video/x-ms-wvx"},
        {"x", "application/directx"},
        {"x3d", "application/vnd.hzn-3d-crossword"},
        {"xaf", "x-world/x-vrml"},
        {"xaml", "application/xaml+xml"},
        {"xap", "application/x-silverlight-app"},
        {"xar", "application/vnd.xara"},
        {"xbap", "application/x-ms-xbap"},
        {"xbd", "application/vnd.fujixerox.docuworks.binder"},
        {"xbm", "image/x-xbitmap"},
        {"xdf", "application/xcap-diff+xml"},
        {"xdm", "application/vnd.syncml.dm+xml"},
        {"xdp", "application/vnd.adobe.xdp+xml"},
        {"xdr", "text/plain"},
        {"xdssc", "application/dssc+xml"},
        {"xdw", "application/vnd.fujixerox.docuworks"},
        {"xenc", "application/xenc+xml"},
        {"xer", "application/patch-ops-error+xml"},
        {"xfdf", "application/vnd.adobe.xfdf"},
        {"xfdl", "application/vnd.xfdl"},
        {"xht", "application/xhtml+xml"},
        {"xhtml", "application/xhtml+xml"},
        {"xif", "image/vnd.xiff"},
        {"xla", "application/vnd.ms-excel"},
        {"xlam", "application/vnd.ms-excel.addin.macroEnabled.12"},
        {"xlc", "application/vnd.ms-excel"},
        {"xld", "application/vnd.ms-excel"},
        {"xlk", "application/vnd.ms-excel"},
        {"xll", "application/vnd.ms-excel"},
        {"xlm", "application/vnd.ms-excel"},
        {"xls", "application/vnd.ms-excel"},
        {"xlsb", "application/vnd.ms-excel.sheet.binary.macroEnabled.12"},
        {"xlsm", "application/vnd.ms-excel.sheet.macroEnabled.12"},
        {"xlsx", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},
        {"xlt", "application/vnd.ms-excel"},
        {"xltm", "application/vnd.ms-excel.template.macroEnabled.12"},
        {"xltx", "application/vnd.openxmlformats-officedocument.spreadsheetml.template"},
        {"xlw", "application/vnd.ms-excel"},
        {"xml", "text/xml"},
        {"xmta", "application/xml"},
        {"xo", "application/vnd.olpc-sugar"},
        {"xof", "x-world/x-vrml"},
        {"xoml", "text/plain"},
        {"xop", "application/xop+xml"},
        {"xpi", "application/x-xpinstall"},
        {"xpm", "image/x-xpixmap"},
        {"xpr", "application/vnd.is-xpr"},
        {"xps", "application/vnd.ms-xpsdocument"},
        {"xpw", "application/vnd.intercon.formnet"},
        {"xrm-ms", "text/xml"},
        {"xsc", "application/xml"},
        {"xsd", "text/xml"},
        {"xsf", "text/xml"},
        {"xsl", "text/xml"},
        {"xslt", "text/xml"},
        {"xsm", "application/vnd.syncml+xml"},
        {"xsn", "application/octet-stream"},
        {"xspf", "application/xspf+xml"},
        {"xss", "application/xml"},
        {"xtp", "application/octet-stream"},
        {"xul", "application/vnd.mozilla.xul+xml"},
        {"xwd", "image/x-xwindowdump"},
        {"xyz", "chemical/x-xyz"},
        {"yang", "application/yang"},
        {"yin", "application/yin+xml"},
        {"z", "application/x-compress"},
        {"zaz", "application/vnd.zzazz.deck+xml"},
        {"zip", "application/x-zip-compressed"},
        {"zir", "application/vnd.zul"},
        {"zmm", "application/vnd.handheld-entertainment+xml"}
    }

    Private Shared ReadOnly _knownIncorrectMimeTypes As New Dictionary(Of String, String)() From {
            {"image/x-png", "image/png"},
            {"image/pjpeg", "image/jpeg"}
        }

    Friend Shared ReadOnly Property MimeTypes As Dictionary(Of String, String)
        Get
            Return _MIMETypesDictionary
        End Get
    End Property

    Friend Shared Function GetFileExtensionByMimeType(mimeType As String) As String
        If _MIMETypesDictionary.ContainsValue(mimeType) Then
            For Each kvp As KeyValuePair(Of String, String) In _MIMETypesDictionary
                If kvp.Value.ToLower() = mimeType.ToLower() Then
                    Return kvp.Key
                End If
            Next
        End If

        Return String.Empty
    End Function

    Friend Shared Function GetMimeTypeFromFile(filename As String) As String
        Return GetMimeTypeFromFile(filename, Nothing)
    End Function

    Friend Shared Function GetMimeTypeFromFile(filename As String, byteArray() As Byte) As String
        Dim mimeType As String = String.Empty
        Dim fileToGetMimeTypeFrom As String = String.Empty
        Dim tempFileCreated As Boolean = False

        If byteArray Is Nothing Then
            fileToGetMimeTypeFrom = filename
        Else
            Dim extension As String = Path.GetExtension(filename).Trim("."c).ToLower
            fileToGetMimeTypeFrom = Path.Combine(TempStorageHelper.GetTempStoragePath(), Guid.NewGuid().ToString())
            If Not String.IsNullOrEmpty(extension) Then
                fileToGetMimeTypeFrom = String.Concat(fileToGetMimeTypeFrom, $".{extension}")
            End If
        End If

        If Not TryGetMimeTypeFromFile(fileToGetMimeTypeFrom, mimeType) Then
            If byteArray IsNot Nothing Then
                File.WriteAllBytes(fileToGetMimeTypeFrom, byteArray)
                tempFileCreated = True
            End If

            If Not File.Exists(fileToGetMimeTypeFrom) Then
                mimeType = String.Empty
            Else
                mimeType = CorrectKnownIncorrectMimeTypes(GetMimeTypeByProbingTheFile(fileToGetMimeTypeFrom))
            End If


            If tempFileCreated Then
                If File.Exists(fileToGetMimeTypeFrom) Then
                    File.Delete(fileToGetMimeTypeFrom)
                End If
            End If
        End If

        Return mimeType
    End Function

    Friend Shared Function GetExtensionsForMimeType(mimeType As String) As List(Of String)
        Return _MIMETypesDictionary.Where(Function(m) m.Value.Equals(mimeType, StringComparison.InvariantCultureIgnoreCase)).Select(Function(m) m.Key).ToList()
    End Function

    Private Shared Function CorrectKnownIncorrectMimeTypes(mimeType As String) As String
        If _knownIncorrectMimeTypes.ContainsKey(mimeType) Then
            Return _knownIncorrectMimeTypes(mimeType)
        End If

        Return mimeType
    End Function

    Private Shared Function TryGetMimeTypeFromFile(fileName As String, ByRef result As String) As Boolean
        Dim extension As String = Path.GetExtension(fileName).Trim(".".ToCharArray()).ToLower

        Return GetMimeTypeByExtension(extension, result)
    End Function

    Friend Shared Function GetMimeTypeByExtension(extension As String, ByRef result As String) As Boolean
        If Not String.IsNullOrEmpty(extension) AndAlso _MIMETypesDictionary.ContainsKey(extension) Then
            result = _MIMETypesDictionary(extension)
            Return True
        End If

        Return False
    End Function

    Private Shared Function GetMimeTypeByProbingTheFile(file As String) As String
        Dim mimeout As IntPtr
        If Not IO.File.Exists(file) Then
            Throw New FileNotFoundException("File '" + file + "' not found")
        End If
        Dim maxContent As Integer = CInt(New FileInfo(file).Length)
        If maxContent > 4096 Then
            maxContent = 4096
        End If

        Dim buf(maxContent) As Byte

        Using fs As New FileStream(file, FileMode.Open, FileAccess.Read)
            fs.Read(buf, 0, maxContent)
        End Using

        WindowsNativeMethods.FindMimeFromData(IntPtr.Zero, file, buf, maxContent, Nothing, 0, mimeout, 0)

        Dim mime As String = Marshal.PtrToStringUni(mimeout)
        Marshal.FreeCoTaskMem(mimeout)
        Return mime
    End Function

End Class
